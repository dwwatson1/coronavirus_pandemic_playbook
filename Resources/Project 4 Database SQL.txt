# Module 20

# Coronavirus Pandemic Playbook
## Group 4
	Leggett, Michael
	Essilfie-Bondzie, DINAH
	Teamir rezene, Yodit
	Ellerbe, Kimberly
	Gross, Jack
	Watson, David


1.	Create the tables for: Age Group, State, Sex, Race, CDC input data, Covid summary data, US Census Data
	All for March 2020 to December 2020
SELECT * FROM DATA_AGE_GROUP
SELECT * FROM US_STATES
SELECT * FROM DATA_SEX
SELECT * FROM DATA_RACE
SELECT * FROM CDC_INPUTDB_CLEANED
SELECT * FROM COVID_MARCH2020_DEC2020_PROJECT4
SELECT * FROM US_CESUS_TOTALS


2.	Working with PostGresSQLin PGAdmin
	Create the table to hold the input data and import the data into it
CREATE TABLE CDC_INPUTDB_CLEANED(
DATA_ID                           INTEGER,
res_state                       TEXT,
age_group                       TEXT,
sex                             TEXT,
race                            TEXT
	);


	Find the options of age group to create the DATA_AGE_GROUP table
CREATE TABLE DATA_AGE_GROUP( AGE_GROUP       TEXT);

INSERT INTO	DATA_AGE_GROUP
( SELECT DISTINCT age_group 
FROM CDC_INPUTDB_CLEANED
GROUP BY  age_group )

	Find the options of sex to create the DATA_SEX table
CREATE TABLE DATA_SEX( SEX       TEXT);

INSERT INTO	DATA_SEX
( SELECT DISTINCT SEX 
FROM CDC_INPUTDB_CLEANED
GROUP BY  SEX )

	Find the options of race to create the DATA_RACE table
CREATE TABLE DATA_RACE( RACE       TEXT);

INSERT INTO	DATA_RACE
( SELECT DISTINCT RACE 
FROM CDC_INPUTDB_CLEANED
GROUP BY  RACE )


3.	Read the query to summarize counts


SELECT DISTINCT RES_STATE
(SELECT COUNT(ID_MD) FROM MARYLAND_DATA WHERE AGE_GROUP LIKE '0 - 17 years') age_group_0_17
(SELECT COUNT(ID_MD) FROM MARYLAND_DATA WHERE AGE_GROUP LIKE '18 to 49 years') age_group_18_49
(SELECT COUNT(ID_MD) FROM MARYLAND_DATA WHERE AGE_GROUP LIKE '50 to 64 years') age_group_50_64
(SELECT COUNT(ID_MD) FROM MARYLAND_DATA WHERE AGE_GROUP LIKE '65+ years') age_group_65PLUS
(SELECT COUNT(ID_MD) FROM MARYLAND_DATA WHERE AGE_GROUP 
 NOT IN ('0 - 17 years'
(SELECT COUNT(ID_MD) FROM MARYLAND_DATA WHERE SEX LIKE 'Female') sex_FEMALE
(SELECT COUNT(ID_MD) FROM MARYLAND_DATA WHERE SEX LIKE 'Male') sex_MALE
(SELECT COUNT(ID_MD) FROM MARYLAND_DATA WHERE SEX NOT IN ('Male'
(SELECT COUNT(ID_MD) FROM MARYLAND_DATA WHERE race LIKE 'White') race_WHITE
(SELECT COUNT(ID_MD) FROM MARYLAND_DATA WHERE race LIKE 'Black') race_BLACK
(SELECT COUNT(ID_MD) FROM MARYLAND_DATA WHERE race LIKE 'Asian') race_ASIAN
(SELECT COUNT(ID_MD) FROM MARYLAND_DATA WHERE race LIKE 'Multiple/Other') race_MULTIPLE_OTHER
(SELECT COUNT(ID_MD) FROM MARYLAND_DATA WHERE race LIKE 'American Indian/Alaska Native') race_AM_INDIAN_ALASKA_NATIVE
(SELECT COUNT(ID_MD) FROM MARYLAND_DATA WHERE race 
 NOT IN ('White'
FROM MARYLAND_DATA ORDER BY 2

(169000796 records)


4.	Create a new table COVID_MARCH2020_DEC2020_PROJECT4
CREATE TABLE COVID_MARCH2020_DEC2020_PROJECT4(
STATE		                    TEXT,
ST		                        TEXT,
age_group_0_17                  INTEGER,
age_group_18_49                 INTEGER,
age_group_50_64                 INTEGER,
age_group_65PLUS                INTEGER,
age_group_no_ID                 INTEGER,
sex_MALE                        INTEGER,
sex_FEMALE                      INTEGER,
sex_no_ID                       INTEGER,
race_ASIAN                      INTEGER,
race_AM_INDIAN_ALASKA_NATIVE    INTEGER,
race_BLACK                      INTEGER,
race_MULTIPLE_OTHER             INTEGER,
race_WHITE                      INTEGER,
race_no_ID                      INTEGER
);


5.      Get the totals and insert into FROM COVID_MARCH2020_DEC2020_PROJECT4


INSERT INTO COVID_MARCH2020_DEC2020_PROJECT4
(
SELECT DISTINCT STATE, RES_STATE ST,
(SELECT COUNT(DATA_ID) FROM CDC_INPUTDB_CLEANED WHERE AGE_GROUP LIKE '0 - 17 years' AND RES_STATE=US_STATES.CODE) age_group_0_17,
(SELECT COUNT(DATA_ID) FROM CDC_INPUTDB_CLEANED WHERE AGE_GROUP LIKE '18 to 49 years' AND RES_STATE=US_STATES.CODE) age_group_18_49,
(SELECT COUNT(DATA_ID) FROM CDC_INPUTDB_CLEANED WHERE AGE_GROUP LIKE '50 to 64 years' AND RES_STATE=US_STATES.CODE) age_group_50_64,
(SELECT COUNT(DATA_ID) FROM CDC_INPUTDB_CLEANED WHERE AGE_GROUP LIKE '65+ years' AND RES_STATE=US_STATES.CODE) age_group_65PLUS,
(SELECT COUNT(DATA_ID) FROM CDC_INPUTDB_CLEANED WHERE AGE_GROUP 
 NOT IN ('0 - 17 years', '18 to 49 years', '50 to 64 years', '65+ years') AND RES_STATE=US_STATES.CODE) age_group_no_ID ,
(SELECT COUNT(DATA_ID) FROM CDC_INPUTDB_CLEANED WHERE SEX LIKE 'Female' AND RES_STATE=US_STATES.CODE) sex_FEMALE,
(SELECT COUNT(DATA_ID) FROM CDC_INPUTDB_CLEANED WHERE SEX LIKE 'Male' AND RES_STATE=US_STATES.CODE) sex_MALE,
(SELECT COUNT(DATA_ID) FROM CDC_INPUTDB_CLEANED WHERE SEX NOT IN ('Male', 'Female') AND RES_STATE=US_STATES.CODE) SEX_no_ID ,
(SELECT COUNT(DATA_ID) FROM CDC_INPUTDB_CLEANED WHERE race LIKE 'White' AND RES_STATE=US_STATES.CODE) race_WHITE, 
(SELECT COUNT(DATA_ID) FROM CDC_INPUTDB_CLEANED WHERE race LIKE 'Black' AND RES_STATE=US_STATES.CODE) race_BLACK, 
(SELECT COUNT(DATA_ID) FROM CDC_INPUTDB_CLEANED WHERE race LIKE 'Asian' AND RES_STATE=US_STATES.CODE) race_ASIAN, 
(SELECT COUNT(DATA_ID) FROM CDC_INPUTDB_CLEANED WHERE race LIKE 'Multiple/Other' AND RES_STATE=US_STATES.CODE) race_MULTIPLE_OTHER, 
(SELECT COUNT(DATA_ID) FROM CDC_INPUTDB_CLEANED WHERE race LIKE 'American Indian/Alaska Native' AND RES_STATE=US_STATES.CODE) race_AM_INDIAN_ALASKA_NATIVE, 
(SELECT COUNT(DATA_ID) FROM CDC_INPUTDB_CLEANED WHERE race 
 NOT IN ('White', 'Black', 'Asian', 'Multiple/Other','American Indian/Alaska Native') AND RES_STATE=US_STATES.CODE) race_no_ID 
	FROM CDC_INPUTDB_CLEANED
	INNER JOIN US_STATES 
	ON RES_STATE=CODE
)




6.	Export the data as csv
EXPORT AS MD_CLEANED
